<!doctype html>
<meta charset="UTF-8">

<head>
  <script src="http://localhost:8080/credentials.js"></script>
  <script src="http://localhost:8080/fractal.js"></script>
</head>

<body>
<input type="button" onclick="loadData()" value="load data"/>
<input type="button" onclick="deleteData()" value="delete data"/>
<input type="button" onclick="saveState()" value="save state"/>
<input type="text" class="save-id">
<input type="button" onclick="loadState()" value="load state"/>
<input type="text" class="load-id">
<div class="containers">
  <div class="container container-1"></div>
  <div class="container container-2"></div>
  <div class="container container-3"></div>
  <div class="container container-4"></div>
</div>
</body>

<script>
  /* eslint-disable */

  const fjs = fractal.init({
    handler: 'test',
    dataSource: 'http://localhost',
    fractalisNode: 'http://localhost:5000',
    getAuth () {
      return {user: '', passwd: ''}
    }
  })
  fjs.setSubsets([
    [...new Array(100).keys()],
    [...new Array(500).keys()].slice(100, 200),
    [...new Array(500).keys()].slice(200, 300)
  ])
  function loadData () {
    fjs.loadData([
      {
        data_type: 'numerical_array',
        label: 'Expression Data',
        num_samples: 300,
        num_features: 100
      },
      {
        data_type: 'numerical',
        label: 'Numerical Data 1',
        num_samples: 300
      },
      {
        data_type: 'numerical',
        label: 'Numerical Data 2',
        num_samples: 300
      },
      {
        data_type: 'numerical',
        label: 'Numerical Data 3',
        num_samples: 300
      },
      {
        data_type: 'categorical',
        label: 'Categorical Data 1',
        num_samples: 300,
        values: ['A', 'B', 'C', 'D']
      },
      {
        data_type: 'categorical',
        label: 'Categorical Data 2',
        num_samples: 300,
        values:['X', 'Y']
      }
    ])
  }

  function deleteData () {
    fjs.clearCache()
  }

  function saveState () {
    fjs.chart2id('.fjs-chart', id => { document.querySelector('.save-id').value = id })
  }

  function loadState () {
    fjs.id2chart('#placeholder4', document.querySelector('.load-id').value)
  }

  function setCharts () {
    // fjs.setChart('correlation-analysis', '.container-1')
    fjs.setChart('boxplot', '.container-2')
    // fjs.setChart('heatmap', '.container-3')
    // fjs.setChart('pca-analysis', '.container-4')
  }

  function resize () {
    const container = document.querySelector('.containers')
    container.style.height = document.documentElement.clientHeight + 'px'
    container.style.width = document.documentElement.clientWidth + 'px'
  }

  window.addEventListener('resize', resize)
  window.addEventListener('load', () => {
    resize()
    setCharts()
  })
</script>

<style>
  .containers {
    width: 1000px;
    height: 1000px;
  }

  .container {
    width: 48%;
    height: 48%;
    float: left;
  }
</style>
